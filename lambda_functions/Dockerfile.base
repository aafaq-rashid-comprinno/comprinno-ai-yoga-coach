# Base image with all dependencies pre-installed
# This will be built once and reused

FROM public.ecr.aws/lambda/python:3.12

# Install system dependencies
RUN dnf install -y mesa-libGL && \
    dnf clean all

# Copy and install Python dependencies
COPY requirements.txt /tmp/
RUN pip install --no-cache-dir -r /tmp/requirements.txt && \
    rm /tmp/requirements.txt

# Set working directory
WORKDIR /var/task
